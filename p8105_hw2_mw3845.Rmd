---
title: "p8105_hw2_mw3845"
author: "Minghe Wang"
date: "2024-09-29"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
```

## Problem 1

###### read and clean the data

```{r problem1_read_and_clean_data}
#read and clean the data
subway_df = 
  read_csv('./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv', na = "",
    col_types = cols(
    Route8 = col_character(),
    Route9 = col_character(),
    Route10 = col_character(),
    Route11 = col_character())
    ) |>
  janitor::clean_names() |>
  select(line:entry, vending, ada) |>
  mutate(
    entry = ifelse(entry=='YES', TRUE, FALSE)
  )
```

So far, we read and clean the data of NYC's subway. The data contains ` line`, `station_name`, `station_latitude`, `station longitude`, `route1` to `route11`, `entry`, `vending`, `entrance_type`, and `ada`. 

- Cleaning steps: the variables' names are converting into lower snake case; the 19 variables mentioned above are selected; and `entry` is converted into logical variable (`YES` to `TRUE`, `NO` to `FALSE`).
- Dimension: the dimension of resulting dataset is `r nrow(subway_df)` x `r ncol(subway_df)`.

###### Analyze dataset with unique stations:

```{r unique station dataframe}
uni_station_df = distinct(subway_df, line, station_name, .keep_all=TRUE) |>
  mutate(
    vending = ifelse(vending=='YES', TRUE, FALSE)
  )
```

- How many distinct stations are there? Note that stations are identified both by name and by line (e.g. 125th St 8th Avenue; 125st Broadway; 125st Lenox); the distinct function may be useful here.

  _There are `r nrow(uni_station_df)` stations in the dataset._
  
- How many stations are ADA compliant?

  _There are `r sum(uni_station_df$ada)` stations are ADA compliant._
  
- What proportion of station entrances / exits without vending allow entrance?

  _`r ((sum(uni_station_df$entry) - sum(uni_station_df$vending)) / nrow(uni_station_df))*100`% of station extrances / exits without vending allow entrance._
  
###### Reformatting the data to analyze the stations that serves A train:
  
```{r reformatting uni_station_df}
# pivot dataframe longer to count A train
longer_uni_station_df = pivot_longer(
  uni_station_df,
  route1:route11,
  names_to = 'route',
  values_to = 'train'
)
# filter the longer dataframe to count ADA compliant A train
a_train_df = longer_uni_station_df %>%
  filter(train == 'A')
```

There are `r sum(longer_uni_station_df$train == 'A', na.rm = TRUE)` distinct stations serve A train. And `r sum(a_train_df$ada)` of the stations that serve A train are ADA compliant.



